"use strict";exports.id=3889,exports.ids=[3889],exports.modules={13889:(a,b,c)=>{c.r(b),c.d(b,{encodeIntoResult:()=>l,stegaEncodeSourceMap:()=>x,stegaEncodeSourceMap$1:()=>y});var d=c(3639);let e=/_key\s*==\s*['"](.*)['"]/;function f(a){if(!Array.isArray(a))throw Error("Path is not an array");return a.reduce((a,b,c)=>{let d=typeof b;if("number"===d)return`${a}[${b}]`;if("string"===d)return`${a}${0===c?"":"."}${b}`;if(("string"==typeof b?e.test(b.trim()):"object"==typeof b&&"_key"in b)&&b._key)return`${a}[_key=="${b._key}"]`;if(Array.isArray(b)){let[c,d]=b;return`${a}[${c}:${d}]`}throw Error(`Unsupported path segment \`${JSON.stringify(b)}\``)},"")}let g={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},h={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function i(a){let b,c=[],d=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;for(;null!==(b=d.exec(a));){if(void 0!==b[1]){let a=b[1].replace(/\\(\\|f|n|r|t|')/g,a=>h[a]);c.push(a);continue}if(void 0!==b[2]){c.push(parseInt(b[2],10));continue}if(void 0!==b[3]){let a=b[3].replace(/\\(\\')/g,a=>h[a]);c.push({_key:a,_index:-1});continue}}return c}function j(a){return a.map(a=>{if("string"==typeof a||"number"==typeof a)return a;if(""!==a._key)return{_key:a._key};if(-1!==a._index)return a._index;throw Error(`invalid segment:${JSON.stringify(a)}`)})}function k(a){return a.map(a=>{if("string"==typeof a||"number"==typeof a)return a;if(-1!==a._index)return a._index;throw Error(`invalid segment:${JSON.stringify(a)}`)})}function l(a,b,c){return function a(b,c,e=[]){if(null!==b&&Array.isArray(b))return b.map((b,f)=>{if((0,d.u4)(b)){let d=b._key;if("string"==typeof d)return a(b,c,e.concat({_key:d,_index:f}))}return a(b,c,e.concat(f))});if((0,d.u4)(b)){if("block"===b._type||"span"===b._type){let d={...b};return"block"===b._type?d.children=a(b.children,c,e.concat("children")):"span"===b._type&&(d.text=a(b.text,c,e.concat("text"))),d}return Object.fromEntries(Object.entries(b).map(([b,d])=>[b,a(d,c,e.concat(b))]))}return c(b,e)}(a,(a,d)=>{if("string"!=typeof a)return a;let e=function(a,b){var c;if(!b?.mappings)return;let d=(c=k(a),`$${c.map(a=>"string"==typeof a?`['${a.replace(/[\f\n\r\t'\\]/g,a=>g[a])}']`:"number"==typeof a?`[${a}]`:""!==a._key?`[?(@._key=='${a._key.replace(/['\\]/g,a=>g[a])}')]`:`[${a._index}]`).join("")}`);if(void 0!==b.mappings[d])return{mapping:b.mappings[d],matchedPath:d,pathSuffix:""};let e=k(a).map(a=>"string"==typeof a?`['${a.replace(/[\f\n\r\t'\\]/g,a=>g[a])}']`:"number"==typeof a?`[${a}]`:""!==a._key?`[?(@._key=='${a._key.replace(/['\\]/g,a=>g[a])}')]`:`[${a._index}]`);for(let a=e.length-1;a>0;a--){let c=`$${e.slice(0,a).join("")}`,f=b.mappings[c];if(f){let a=d.substring(c.length);return{mapping:f,matchedPath:c,pathSuffix:a}}}}(d,b);if(!e)return a;let{mapping:f,matchedPath:h}=e;if("value"!==f.type||"documentValue"!==f.source.type)return a;let j=b.documents[f.source.document],l=b.paths[f.source.path],m=i(h);return c({sourcePath:i(l).concat(d.slice(m.length)),sourceDocument:j,resultPath:d,value:a})})}let m="drafts.";function n(a){return a.startsWith(m)}function o(a){return a.startsWith("versions.")}let p=({sourcePath:a,resultPath:b,value:c})=>{var d;if(d=c,/^\d{4}-\d{2}-\d{2}/.test(d)&&Date.parse(d)||function(a){try{let{protocol:b}=new URL(a,a.startsWith("/")?"https://acme.com":void 0);return r.has(b)||b.startsWith("web+")}catch{return!1}}(c))return!1;let e=a.at(-1);return!("slug"===a.at(-2)&&"current"===e||"string"==typeof e&&(e.startsWith("_")||e.endsWith("Id"))||a.some(a=>"meta"===a||"metadata"===a||"openGraph"===a||"seo"===a)||s(a)||s(b)||"string"==typeof e&&q.has(e))},q=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","textTheme","unit","url","username","variant","website"]),r=new Set(["app:","data:","discord:","file:","ftp:","ftps:","geo:","http:","https:","imap:","javascript:","magnet:","mailto:","maps:","ms-excel:","ms-powerpoint:","ms-word:","slack:","sms:","spotify:","steam:","teams:","tel:","vscode:","zoom:"]);function s(a){return a.some(a=>"string"==typeof a&&null!==a.match(/type/i))}let t=[8203,8204,8205,65279],u=t.map(a=>String.fromCharCode(a)),v=[8203,8204,8205,8290,8291,8288,65279,8289,119155,119156,119157,119158,119159,119160,119161,119162];Object.fromEntries(t.map((a,b)=>[a,b])),Object.fromEntries(v.map((a,b)=>[a,b.toString(16)]));let w=String.fromCodePoint(t[0]).repeat(4);function x(a,b,c){let{filter:d,logger:g,enabled:h}=c;if(!h){let d="config.enabled must be true, don't call this function otherwise";throw g?.error?.(`[@sanity/client]: ${d}`,{result:a,resultSourceMap:b,config:c}),TypeError(d)}if(!b)return g?.error?.("[@sanity/client]: Missing Content Source Map from response body",{result:a,resultSourceMap:b,config:c}),a;if(!c.studioUrl){let d="config.studioUrl must be defined";throw g?.error?.(`[@sanity/client]: ${d}`,{result:a,resultSourceMap:b,config:c}),TypeError(d)}let i=[],k=[],q=l(a,b,({sourcePath:a,sourceDocument:b,resultPath:e,value:h})=>{var l;let q;if(("function"==typeof d?d({sourcePath:a,resultPath:e,filterDefault:p,sourceDocument:b,value:h}):p({sourcePath:a,resultPath:e,value:h}))===!1)return g&&k.push({path:f(j(a)),value:`${h.slice(0,20)}${h.length>20?"...":""}`,length:h.length}),h;g&&i.push({path:f(j(a)),value:`${h.slice(0,20)}${h.length>20?"...":""}`,length:h.length});let{baseUrl:r,workspace:s,tool:t}=("/"!==(q="string"==typeof(l="function"==typeof c.studioUrl?c.studioUrl(b):c.studioUrl)?l:l.baseUrl)&&(q=q.replace(/\/$/,"")),"string"==typeof l?{baseUrl:q}:{...l,baseUrl:q});if(!r)return h;let{_id:v,_type:x,_projectId:y,_dataset:z}=b;return function(a,b,c="auto"){var d;return!0!==c&&("auto"!==c||(d=a)&&"string"==typeof d&&Date.parse(d)||function(a){try{return new URL(a,a.startsWith("/")?"https://example.com":void 0),!0}catch{return!1}}(a))?a:`${a}${function(a){if(void 0===a)return"";let b="string"==typeof a?a:JSON.stringify(a),c=new TextEncoder().encode(b),d="";for(let a=0;a<c.length;a++){let b=c[a];d+=u[b>>6&3]+u[b>>4&3]+u[b>>2&3]+u[3&b]}return w+d}(b)}`}(h,{origin:"sanity.io",href:function(a){let{baseUrl:b,workspace:c="default",tool:d="default",id:e,type:g,path:h,projectId:i,dataset:k}=a;if(!b)throw Error("baseUrl is required");if(!h)throw Error("path is required");if(!e)throw Error("id is required");if("/"!==b&&b.endsWith("/"))throw Error("baseUrl must not end with a slash");let l="default"===c?void 0:c,p="default"===d?void 0:d,q=o(e)?e.split(".").slice(2).join("."):n(e)?e.slice(m.length):e,r=Array.isArray(h)?f(j(h)):h,s=new URLSearchParams({baseUrl:b,id:q,type:g,path:r});if(l&&s.set("workspace",l),p&&s.set("tool",p),i&&s.set("projectId",i),k&&s.set("dataset",k),n(e)||o(e)){if(o(e)){let a=function(a){if(!o(a))return;let[b,c,...d]=a.split(".");return c}(e);s.set("perspective",a)}}else s.set("perspective","published");let t=["/"===b?"":b];l&&t.push(l);let u=["mode=presentation",`id=${q}`,`type=${g}`,`path=${encodeURIComponent(r)}`];return p&&u.push(`tool=${p}`),t.push("intent","edit",`${u.join(";")}?${s}`),t.join("/")}({baseUrl:r,workspace:s,tool:t,id:v,type:x,path:a,...!c.omitCrossDatasetReferenceData&&{dataset:z,projectId:y}})},!0)});if(g){let a=k.length,b=i.length;if((a||b)&&((g?.groupCollapsed||g.log)?.("[@sanity/client]: Encoding source map into result"),g.log?.(`[@sanity/client]: Paths encoded: ${i.length}, skipped: ${k.length}`)),i.length>0&&(g?.log?.("[@sanity/client]: Table of encoded paths"),(g?.table||g.log)?.(i)),k.length>0){let a=new Set;for(let{path:b}of k)a.add(b.replace(e,"0").replace(/\[\d+\]/g,"[]"));g?.log?.("[@sanity/client]: List of skipped paths",[...a.values()])}(a||b)&&g?.groupEnd?.()}return q}[...t,...v].map(a=>`\\u{${a.toString(16)}}`).join("");var y=Object.freeze({__proto__:null,stegaEncodeSourceMap:x})}};